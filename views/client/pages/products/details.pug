extends ../../layouts/default.pug 
block main 
   div(class="product-detail-container container py-5")
  
 
    div(class="row mb-4")
        div(class="col-12")
        nav(aria-label="breadcrumb")
            ol(class="breadcrumb")
            li(class="breadcrumb-item"): a(href="/") Homepage
            li(class="breadcrumb-item"): a(href="/products") Products
            li(class="breadcrumb-item active", aria-current="page") #{product.title}

    div(class="row align-items-center") 
        //- align-items-center giúp nội dung căn giữa theo chiều dọc nếu ảnh quá cao

        //- 1. CỘT TRÁI: Chỉ chứa Hình ảnh
        div(class="col-12 col-md-6 mb-4 mb-md-0")
        div(class="product-image-wrapper")
            img(src=product.thumbnail, alt=product.title, class="img-fluid shadow-sm rounded", id="mainImg")

        //- 2. CỘT PHẢI: Thông tin và Form mua hàng
        div(class="col-12 col-md-6")
        div(class="product-info-content ps-md-4") 
            //- ps-md-4 tạo khoảng cách đệm giữa ảnh và chữ trên desktop

            //- Tiêu đề
            h1(class="product-title display-6 fw-bold mb-3") #{product.title}

            //- Khu vực giá (Làm gọn lại)
            div(class="price-block d-flex align-items-center gap-3 mb-4")
            //- Giá mới (To và đậm)
            span(class="current-price text-primary fw-bold h2 mb-0") $#{Math.floor(parseFloat(product.price))}
            
            //- Giá cũ & Giảm giá (Chỉ hiện khi có discount)
            if product.discountPercentage > 0
                - var oldPrice = (parseFloat(product.price) * 100) / (100 - parseFloat(product.discountPercentage))
                div(class="d-flex flex-column")
                span(class="original-price text-muted text-decoration-line-through small") $#{Math.floor(oldPrice)}
                span(class="badge bg-danger") -#{product.discountPercentage}%
            
            //- Mô tả
            div(class="product-description mb-4 text-secondary")
            p #{product.description}
            
            //- Form mua hàng
            form(action=`/cart/add/${product.id}`, method="POST")
            div(class="row g-3 align-items-center")
                //- Chọn số lượng
                div(class="col-4 col-md-3")
                div(class="input-group input-group-sm quantity-wrapper")
                    button(type="button", class="btn btn-light border", onclick="decreaseQty()") -
                    input(type="number", class="form-control text-center border-start-0 border-end-0", name="quantity", value="1", min="1", id="qtyInput")
                    button(type="button", class="btn btn-light border", onclick="increaseQty()") +
                
                //- Nút mua
                div(class="col-8 col-md-9")
                button(type="submit", class="btn btn-primary w-100 py-2 fw-bold shadow-sm btn-add-cart") 
                    i(class="fa-solid fa-cart-shopping me-2") 
                    | Thêm vào giỏ hàng
                
    
    script(src="/js/script.js")